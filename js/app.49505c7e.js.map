{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue?7e02","webpack:///./src/components/Waveform.vue?3dc0","webpack:///./src/App.vue?f1b6","webpack:///./src/components/MidiDemo.vue?af9b","webpack:///./src/components/Waveform.vue?db65","webpack:///./src/components/piano.vue?3193","webpack:///src/components/piano.vue","webpack:///./src/components/piano.vue?9545","webpack:///./src/components/piano.vue","webpack:///./src/roll/Note.js","webpack:///./src/roll/Score.js","webpack:///./src/roll/Roll.js","webpack:///src/components/Waveform.vue","webpack:///./src/components/Waveform.vue?08b6","webpack:///./src/components/Waveform.vue","webpack:///src/components/MidiDemo.vue","webpack:///./src/components/MidiDemo.vue?14ce","webpack:///./src/components/MidiDemo.vue","webpack:///src/App.vue","webpack:///./src/App.vue?1160","webpack:///./src/App.vue","webpack:///./src/store.js","webpack:///./src/main.js","webpack:///./src/components/piano.vue?9108","webpack:///./src/components/MidiDemo.vue?31c1"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","_vm","this","_h","$createElement","_c","_self","attrs","staticRenderFns","staticClass","_v","staticStyle","padding","slot","on","changeBackgroundColor","model","callback","$$v","wvBackgroundColor","expression","changeWaveColor","wvWaveColor","changeProgressColor","wvProgressColor","resetColor","taskIdShow","_s","taskId","itemId","studyNumPass","studyNumAll","_e","uid","audioName","checkUserName","checkUserId","labelUserName","ref","onChange","tmpvalue","_l","item","index","instrument","playMusic","changeZoom","changeLongHotKey","changeShortHotKey","preview","changeSpace","previewTime","getButtonAttr","getTask","style","class","concat","indexOf","Math","max","min","num","offsets","octaveStart","octaveEnd","noteStart","noteEnd","methods","calculateOctave","computed","offsetStart","clamp","MIN_NOTE","MAX_NOTE","offsetEnd","totalWhiteKeys","totalBlackKeys","totalKeys","numOctaves","keys","step","nowNum","component","Note","noteDescription","displayOptions","noteOn","Transport","toSeconds","time","duration","noteOff","strokeColor","fillColor","note","velocity","midiNote","midi","top","noteHeight","left","pixelsPerSecond","width","height","context","beginPath","fillStyle","strokeStyle","fillRect","lineWidth","moveTo","lineTo","closePath","lineJoin","stroke","element","remove","Score","scrollElement","scrollC","bpm","notes","currentlyDisplayedNotes","intervalTree","canvas","document","getElementById","canvasWidth","canvasHeight","getContext","addEventListener","resize","_currentNotes","clearNotes","offsetHeight","createIntervalTree","lowMidi","insert","console","log","round","offsetWidth","setNotes","lastOff","from","to","fromSeconds","queryInterval","res","dispose","offset","clearRect","save","drawBg","translate","draw","restore","colors","oneHeight","tmpoffset","oneW","Roll","head","wavesurfer","autoAdvance","lastUpdate","_wavesurfer","_element","_scrollContainer","_scrollElement","_scrollTopArea","_line","_head","_bpm","tempos","_score","_started","_currentScroll","_alreadyRun","_lastFlag","_bindedLoop","_loop","_width","_resize","onscroll","_onscroll","onclick","_onclick","e","seekTo","offsetX","drawer","wrapper","scrollLeft","_onScreenNotes","showOnScreenNotes","currentTime","containerTimeLength","scrolledTime","waveScrollLeft","waveDuration","tmpValue","newV","newv","track","scrollTop","oldV","components","piano","props","type","String","default","Number","playing","tracks","showTrack","update","value1","MidiHead","roll","userToBeCheckedName","checkBtnAttr","addButtonAttr","submitButtonAttr","abandonButtonAttr","labelDataOrigin","labelData","datetime","lyricsItems","lyricsSaveItems","tablePageLength","currentPage","appointTime","rate","pixel","getTaskTime","submitTaskTime","dialogVisible","errorDesOptions","errOptionObj","errorDes","fontSize","fontSizeStyle","trueResult","errThre","errNumThre","errData","errDataVisible","rePaintTable","flagArr","errDescriptions","isModified","flashWaveColor","flashProgressColor","beforeMount","readStorage","mounted","that","containerWidth","onresize","$nextTick","container","autoCenter","partialRender","pixelRatio","backgroundColor","cursorColor","waveColor","progressColor","backend","mediaControls","audioRate","scrollParent","fillParent","hideScrollbar","responsive","plugins","_this","fastKey","event","keyCode","backward","forward","clearRegs","playSelect","pageUp","pageDown","id","color","handleStyle","right","beforeDestroy","removeEventListener","instance","close","writeStroage","formatTooltip","val","handleChange","changeMidi","getMidi","abandonEventDone","localStorage","storage","getItem","$message","message","setItem","setBackgroundColor","setWaveColor","zoom","setProgressColor","playPause","start","stop","changeXAxis","changeLong","changeShort","skip","clearRegions","setPlaybackRate","regions","list","toFixed","end","play","addSelect","row","labelTimeStart","labelTimeEnd","timeNow","setTimeout","Waveform","MidiDemo","Vue","use","Vuex","Store","state","mutations","actions","config","productionTip","ElementUI","store","render","h","App","$mount"],"mappings":"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","file":"js/app.49505c7e.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/midi-test/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","export * from \"-!../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=style&index=0&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Waveform.vue?vue&type=style&index=0&id=f76de944&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('MidiDemo')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"page\"},[_c('h1',[_vm._v(\"Here is a midi display demo by Molar~\")]),_c('Waveform')],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('el-row',{attrs:{\"id\":\"datasource\"}},[_c('el-col',{attrs:{\"span\":24}},[_c('el-card',{staticClass:\"box-card\",staticStyle:{\"text-align\":\"left\"},attrs:{\"body-style\":{ padding: '5px 20px' }}},[_c('div',{staticClass:\"clearfix title\",staticStyle:{\"display\":\"flex\",\"align-items\":\"center\"},attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('el-tooltip',{staticClass:\"item\",attrs:{\"effect\":\"dark\",\"content\":\"音轨背景色\",\"placement\":\"bottom\"}},[_c('el-color-picker',{attrs:{\"show-alpha\":\"\",\"size\":\"mini\"},on:{\"active-change\":_vm.changeBackgroundColor},model:{value:(_vm.wvBackgroundColor),callback:function ($$v) {_vm.wvBackgroundColor=$$v},expression:\"wvBackgroundColor\"}})],1),_c('el-tooltip',{staticClass:\"item\",attrs:{\"effect\":\"dark\",\"content\":\"未播放音轨颜色\",\"placement\":\"bottom\"}},[_c('el-color-picker',{staticStyle:{\"margin-left\":\"15px\"},attrs:{\"show-alpha\":\"\",\"size\":\"mini\"},on:{\"active-change\":_vm.changeWaveColor},model:{value:(_vm.wvWaveColor),callback:function ($$v) {_vm.wvWaveColor=$$v},expression:\"wvWaveColor\"}})],1),_c('el-tooltip',{staticClass:\"item\",attrs:{\"effect\":\"dark\",\"content\":\"已播放音轨颜色\",\"placement\":\"bottom\"}},[_c('el-color-picker',{staticStyle:{\"margin-left\":\"15px\"},attrs:{\"show-alpha\":\"\",\"size\":\"mini\"},on:{\"active-change\":_vm.changeProgressColor},model:{value:(_vm.wvProgressColor),callback:function ($$v) {_vm.wvProgressColor=$$v},expression:\"wvProgressColor\"}})],1),_c('el-button',{staticStyle:{\"margin-left\":\"30px\"},attrs:{\"type\":\"primary\",\"size\":\"mini\"},on:{\"click\":_vm.resetColor}},[_vm._v(\"重置\")]),(_vm.mode == 'STUDY_MODE' && _vm.taskIdShow)?_c('span',{staticStyle:{\"position\":\"absolute\",\"right\":\"20px\"}},[_c('el-tag',[_vm._v(\"任务Id \"+_vm._s(this.taskId))]),_c('el-tag',[_vm._v(\"itemId \"+_vm._s(this.itemId))]),_c('el-tag',[_vm._v(\"学习进度 \"+_vm._s(this.studyNumPass)+\" / \"+_vm._s(this.studyNumAll))])],1):_vm._e(),(_vm.taskIdShow && _vm.mode != 'STUDY_MODE' && _vm.mode != 'CHECK_MODE')?_c('span',{staticStyle:{\"position\":\"absolute\",\"right\":\"20px\"}},[_c('el-tag',[_vm._v(\"任务uid:\"+_vm._s(this.uid))]),_c('el-tag',[_vm._v(\"taskId:\"+_vm._s(this.taskId))]),_c('el-tag',[_vm._v(_vm._s(this.audioName))]),(_vm.mode != 'LABEL_MODE ')?_c('el-tag',[_vm._v(\"审核员:\"+_vm._s(_vm.checkUserName ? _vm.checkUserName : _vm.checkUserId))]):_vm._e()],1):_vm._e(),(_vm.taskIdShow && _vm.mode == 'CHECK_MODE')?_c('span',{staticStyle:{\"position\":\"absolute\",\"right\":\"20px\"}},[_c('el-tag',[_vm._v(\"任务uid:\"+_vm._s(this.uid))]),_c('el-tag',[_vm._v(\"taskId:\"+_vm._s(this.taskId))]),_c('el-tag',[_vm._v(_vm._s(this.audioName))]),_c('el-tag',[_vm._v(\"标注员：\"+_vm._s(_vm.labelUserName))])],1):_vm._e()],1),_c('div',[_c('div',{ref:\"waveform\",attrs:{\"id\":\"waveform\"}}),_c('div',{ref:\"wave-timeline\",attrs:{\"id\":\"wave-timeline\"}})]),_c('div',{staticClass:\"ScrollArea\",attrs:{\"id\":\"test\"}},[_c('div',{staticClass:\"container\",attrs:{\"id\":\"container\"}},[_c('div',{staticClass:\"piano\"},[_c('piano')],1),_c('div',{staticClass:\"roll\"},[_c('div',{attrs:{\"id\":\"root\"}},[_c('div',{attrs:{\"id\":\"RollContainer\"}},[_c('div',{attrs:{\"id\":\"ScrollContainer\"}},[_c('div',{attrs:{\"id\":\"PianoRoll\"}}),_c('div',{attrs:{\"id\":\"line\"}})]),_c('canvas',{attrs:{\"id\":\"ScoreCanvas\"}})])])])])]),_c('el-row',{staticStyle:{\"margin-top\":\"20px\"}},[_c('el-select',{staticStyle:{\"margin\":\"10px 10px\"},attrs:{\"placeholder\":\"当前未选择\"},on:{\"change\":_vm.onChange},model:{value:(_vm.tmpvalue),callback:function ($$v) {_vm.tmpvalue=$$v},expression:\"tmpvalue\"}},_vm._l((_vm.tracks),function(item){return _c('el-option',{key:'track' + item.index,attrs:{\"label\":'Track:' + item.index + ' Instrument:' + item.instrument.name,\"value\":item.index}})}),1),_c('el-button',{staticStyle:{\"margin-right\":\"10px\"},attrs:{\"type\":\"primary\",\"size\":\"small\"},on:{\"click\":_vm.playMusic}},[_c('i',{staticClass:\"el-icon-video-play\"}),_vm._v(\" 播放 / \"),_c('i',{staticClass:\"el-icon-video-pausee\"}),_vm._v(\" 暂停 \")]),_c('el-tooltip',{staticClass:\"item\",attrs:{\"effect\":\"dark\",\"content\":\"放大倍率\",\"placement\":\"bottom\"}},[_c('el-input-number',{attrs:{\"size\":\"small\",\"precision\":0,\"step\":20,\"min\":80,\"max\":1500},on:{\"change\":_vm.changeZoom},model:{value:(_vm.value),callback:function ($$v) {_vm.value=$$v},expression:\"value\"}})],1),_c('el-button',{staticStyle:{\"margin-left\":\"10px\"},attrs:{\"size\":\"small\",\"onfocus\":\"this.blur()\"},on:{\"click\":_vm.changeLongHotKey}},[_vm._v(\"一键放大\")]),_c('el-button',{attrs:{\"size\":\"small\",\"onfocus\":\"this.blur()\"},on:{\"click\":_vm.changeShortHotKey}},[_vm._v(\"一键缩小\")]),_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\",\"onfocus\":\"this.blur()\"},on:{\"click\":_vm.preview}},[_vm._v(\"预览\")]),_c('el-tooltip',{staticClass:\"item\",attrs:{\"effect\":\"dark\",\"content\":\"预览时长\",\"placement\":\"bottom\"}},[_c('el-popover',{staticStyle:{\"margin-left\":\"10px\"},attrs:{\"placement\":\"top\",\"width\":\"220\",\"trigger\":\"click\"}},[_c('el-input-number',{attrs:{\"width\":\"180\",\"precision\":2,\"step\":0.1,\"min\":0.1,\"max\":10},on:{\"change\":_vm.changeSpace},model:{value:(_vm.previewTime),callback:function ($$v) {_vm.previewTime=$$v},expression:\"previewTime\"}}),_c('el-button',{attrs:{\"slot\":\"reference\",\"size\":\"small\",\"round\":\"\"},slot:\"reference\"},[_vm._v(\" \"+_vm._s(_vm.previewTime + \" s\")+\" \")])],1)],1),_c('el-button',{staticStyle:{\"margin-left\":\"10px\"},attrs:{\"type\":\"primary\",\"size\":\"small\",\"disabled\":_vm.getButtonAttr,\"onfocus\":\"this.blur()\"},on:{\"click\":_vm.getTask}},[_vm._v(\"领取任务 \")])],1)],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"keyboard\",style:(_vm.style)},[_c('ul',_vm._l((_vm.keys),function(key,index){return _c('li',{key:index,class:[].concat( key.class ),style:(key.style)},[(key.name.indexOf('C') != -1 && key.name.indexOf('#') === -1)?_c('span',[_vm._v(_vm._s(key.name))]):_vm._e()])}),0)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"keyboard\" :style=\"style\">\r\n    <ul>\r\n      <li\r\n        v-for=\"(key, index) in keys\"\r\n        :key=\"index\"\r\n        :style=\"key.style\"\r\n        :class=\"[...key.class]\"\r\n      >\r\n        <!-- @click=\"toggleActive(key.name)\" -->\r\n        \r\n        <span\r\n          v-if=\"key.name.indexOf('C') != -1 && key.name.indexOf('#') === -1\"\r\n          >{{ key.name }}</span\r\n        >\r\n      </li>\r\n    </ul>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nconst WHITE_KEYS = [\"C\", \"D\", \"E\", \"F\", \"G\", \"A\", \"B\"];\r\nconst BLACK_KEYS = [\"C#\", \"D#\", null, \"F#\", \"G#\", \"A#\", null];\r\nconst NUM_WHITE_KEYS_PER_OCTAVE = 7;\r\nconst NUM_BLACK_KEYS_PER_OCTAVE = 5;\r\nconst MIN_OCTAVE = -1;\r\nconst MAX_OCTAVE = 9;\r\nconst MIN_NOTE = 0;\r\nconst MAX_NOTE = 6;\r\n\r\nconst clamp = (num, min, max) => {\r\n  return Math.max(min, Math.min(max, num));\r\n};\r\nexport default {\r\n  data() {\r\n    return {\r\n      offsets: {\r\n        octaveStart: -1,\r\n        octaveEnd: 9,\r\n        noteStart: 0,\r\n        noteEnd: 4,\r\n      },\r\n    };\r\n  },\r\n\r\n  methods: {\r\n    calculateOctave(n) {\r\n      return (\r\n        Math.floor(n / NUM_WHITE_KEYS_PER_OCTAVE) +\r\n        Math.max(MIN_OCTAVE, this.offsets.octaveStart)\r\n      );\r\n    },\r\n  },\r\n\r\n  computed: {\r\n    offsetStart() {\r\n      return clamp(this.offsets.noteStart, MIN_NOTE, MAX_NOTE);\r\n    },\r\n\r\n    offsetEnd() {\r\n      return clamp(this.offsets.noteEnd, MIN_NOTE, MAX_NOTE);\r\n    },\r\n\r\n    totalWhiteKeys() {\r\n      return (\r\n        this.numOctaves * NUM_WHITE_KEYS_PER_OCTAVE -\r\n        this.offsets.noteStart -\r\n        (NUM_WHITE_KEYS_PER_OCTAVE - (this.offsets.noteEnd + 1))\r\n      );\r\n    },\r\n\r\n    totalBlackKeys() {\r\n      return (\r\n        this.numOctaves * NUM_BLACK_KEYS_PER_OCTAVE -\r\n        this.offsets.noteStart -\r\n        (NUM_BLACK_KEYS_PER_OCTAVE - (this.offsets.noteEnd + 1))\r\n      );\r\n    },\r\n\r\n    totalKeys() {\r\n      return this.totalWhiteKeys + this.totalBlackKeys;\r\n    },\r\n\r\n    numOctaves() {\r\n      return (\r\n        1 +\r\n        (Math.min(MAX_OCTAVE, this.offsets.octaveEnd) -\r\n          Math.max(MIN_OCTAVE, this.offsets.octaveStart))\r\n      );\r\n    },\r\n\r\n    style() {\r\n      return {\r\n        \"--keys\": this.totalWhiteKeys,\r\n        \"--octaves\": this.numOctaves,\r\n      };\r\n    },\r\n\r\n    keys() {\r\n      const keys = [];\r\n\r\n      // White keys.\r\n      let nowNum = 1; //记录当前跨度\r\n      for (let i = this.offsetStart, j = 0; j < this.totalWhiteKeys; i++, j++) {\r\n        const octave = this.calculateOctave(i);\r\n        const keyName = WHITE_KEYS[i % 7];\r\n\r\n        // Skip < A0\r\n        // if (octave === 0 && WHITE_KEYS.indexOf(keyName) < 5) {\r\n        //   continue\r\n        // }\r\n        let step = 3;\r\n        // console.log(i%7)\r\n        if (i % 7 === 1 || i % 7 === 4 || i % 7 === 5) step = 4;\r\n        const key = {\r\n          name: `${keyName}${octave}`,\r\n          class: [\"white\"],\r\n          style: {\r\n            \"grid-row\": `${nowNum} / span ${step}`,\r\n          },\r\n        };\r\n        nowNum += step;\r\n\r\n        keys.push(key);\r\n      }\r\n\r\n      // Black keys.\r\n      nowNum = 0;\r\n      for (let i = this.offsetStart, j = 0; j < this.totalWhiteKeys; i++, j++) {\r\n        let step = 3;\r\n        // console.log(i%7)\r\n        if (i % 7 === 1 || i % 7 === 4 || i % 7 === 5) step = 4;\r\n        nowNum +=step;\r\n        const octave = this.calculateOctave(i);\r\n        const keyName = BLACK_KEYS[i % 7];\r\n\r\n        // Skip E♯ (F) or B♯ (C).\r\n        if (!keyName) {\r\n          continue;\r\n        }\r\n\r\n        // Skip > C8.\r\n        // if (octave >= 9) {\r\n          if (octave >= 10) {\r\n          continue;\r\n        }\r\n        if (octave === 9 && i % 7 === 4) continue;\r\n\r\n        // const keyNameClass = keyName.replace(\"#\", \"s\");\r\n\r\n        const key = {\r\n          name: `${keyName}${octave}`,\r\n          class: [\"black\"],\r\n          style: {\r\n            \"grid-row\": `${nowNum} / span 2`,\r\n          },\r\n        };\r\n\r\n        keys.push(key);\r\n      }\r\n\r\n      return keys;\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\nbody,\r\nul {\r\n  margin: 0;\r\n  padding: 0;\r\n}\r\n\r\n.keyboard {\r\n  width: 100%;\r\n  /* height: calc(260px - calc(var(--octaves) * 10px)); */\r\n  height: 100%;\r\n  /* overflow-x: hidden; */\r\n}\r\n\r\n.keyboard ul {\r\n  height: 100%;\r\n  width: 100%;\r\n  list-style-type: none;\r\n  display: grid;\r\n  grid-template-rows: repeat(256, 1fr);\r\n  grid-template-columns: repeat(3, 1fr);\r\n}\r\n\r\nli {\r\n  text-align: end;\r\n  background-color: white;\r\n  border: 1px solid black;\r\n  /* display: flex; */\r\n  justify-content: center;\r\n  align-items: flex-end;\r\n  padding-bottom: 0.25rem;\r\n  font-weight: bold;\r\n  border-radius: 0 3px 3px 0;\r\n}\r\n\r\nli.black span {\r\n  /* transform: rotate(90deg); */\r\n  text-align: center;\r\n  transform-origin: center 50%;\r\n  /* margin-bottom: 0.75rem; */\r\n}\r\n\r\n.white {\r\n  grid-column: 1 / span 3;\r\n  z-index: 2;\r\n}\r\n\r\n.black {\r\n  grid-column: 1 / span 2;\r\n  background-color: black;\r\n  color: white;\r\n  z-index: 3;\r\n}\r\n\r\n.blank {\r\n  border-width: 0;\r\n  grid-column: 1 / span 2;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./piano.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./piano.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./piano.vue?vue&type=template&id=746bffe9&scoped=true&\"\nimport script from \"./piano.vue?vue&type=script&lang=js&\"\nexport * from \"./piano.vue?vue&type=script&lang=js&\"\nimport style0 from \"./piano.vue?vue&type=style&index=0&id=746bffe9&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"746bffe9\",\n  null\n  \n)\n\nexport default component.exports","import { Transport } from \"tone\"\r\n\r\nexport class Note {\r\n    constructor(noteDescription, displayOptions) {\r\n        this.noteOn = Transport.toSeconds(noteDescription.time);\r\n        this.duration = Transport.toSeconds(noteDescription.duration);\r\n        this.noteOff = this.noteOn + this.duration;\r\n        this.strokeColor = \"#A2F0B1\";\r\n        this.fillColor = \"#217230\";\r\n        this.note = noteDescription.name;\r\n        this.velocity = noteDescription.velocity;\r\n        this.midiNote = noteDescription.midi;\r\n        var top = this.midiNote;\r\n        top *= displayOptions.noteHeight;\r\n        this.top = top;\r\n        this.left = this.noteOn * displayOptions.pixelsPerSecond;\r\n        this.width = (this.duration * displayOptions.pixelsPerSecond);\r\n        // this.width = Math.max(this.width,4);\r\n        this.height = displayOptions.noteHeight;\r\n    }\r\n    draw(context) {\r\n        context.beginPath();\r\n        context.fillStyle = this.fillColor;\r\n        context.strokeStyle = this.strokeColor;\r\n        context.fillRect(this.left * 2, this.top * 2, this.width * 2, this.height * 2);\r\n        let padding = Math.min(Math.min(this.width, 6), Math.min(this.height, 6));\r\n        let lineWidth = this.height * 2 - padding * 2;\r\n        //overflow -> don't display\r\n        if (lineWidth >= this.width) {\r\n            context.lineWidth = this.width;\r\n        }\r\n        else {\r\n            context.lineWidth = lineWidth;\r\n        }\r\n\r\n        context.beginPath();\r\n        context.moveTo(this.left * 2 + padding + lineWidth / 2, this.top * 2 + padding + lineWidth / 2);\r\n        context.lineTo(this.left * 2 + this.width * 2 - padding - lineWidth / 2, this.top * 2 + padding + lineWidth / 2);\r\n        context.closePath();\r\n        context.lineJoin = \"round\";\r\n        context.stroke();\r\n\r\n    }\r\n    dispose() {\r\n        this.element.remove();\r\n        this.element = null;\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","import createIntervalTree from \"interval-tree-1d\"\r\nimport { Note } from \"./Note.js\"\r\nexport class Score {\r\n    constructor(scrollElement, scrollC, bpm) {\r\n\r\n        /**\r\n         *  all of the notes\r\n         */\r\n        this.notes = [];\r\n        this.bpm = bpm;\r\n        /**\r\n         *  useful for drawing / scrubbing\r\n         */\r\n        this.pixelsPerSecond = 200;\r\n        /**\r\n         *  the score container\r\n         */\r\n\r\n        this.element = scrollElement;\r\n\r\n        /**\r\n         *  the notes that are currently displayed\r\n         */\r\n        this.currentlyDisplayedNotes = [];\r\n\r\n        /**\r\n         *  the interval tree\r\n         */\r\n        this.intervalTree = null;\r\n\r\n        /**\r\n         * the width of the scroll container\r\n         */\r\n        this.width = 0;\r\n        this.scrollC = scrollC;\r\n        /**\r\n         * The canvas which notes are drawn to\r\n         * @type {Element}\r\n         */\r\n        this.canvas = document.getElementById(\"ScoreCanvas\");\r\n\r\n        /**\r\n         * The canvas measurements\r\n         */\r\n        this.canvasWidth = 0;\r\n        this.canvasHeight = 0;\r\n\r\n        this.context = this.canvas.getContext(\"2d\");\r\n\r\n        window.addEventListener(\"resize\", this.resize.bind(this));\r\n        this.resize();\r\n\r\n        this._currentNotes = null;\r\n\r\n    }\r\n    /**\r\n     *  Set the array of notes\r\n     */\r\n    setNotes(notes, duration) {\r\n        this._currentNotes = notes;\r\n        this.clearNotes();\r\n        var noteHeight = (this.scrollC.offsetHeight - 25) / 128;\r\n        var displayOptions = {\r\n            \"min\": 0,\r\n            \"max\": 127,\r\n            \"pixelsPerSecond\": this.pixelsPerSecond,\r\n            \"noteHeight\": noteHeight\r\n        };\r\n        this.intervalTree = new createIntervalTree();\r\n        // var duration = -Infinity;\r\n        var lowMidi = 127;\r\n        // var maxMidi = 0;\r\n        for (var i = 0; i < notes.length; i++) {\r\n            var note = new Note(notes[i], displayOptions);\r\n            // if (note.noteOff > duration) {\r\n            //     duration = note.noteOff;\r\n            // }\r\n            (note.midiNote < lowMidi) && (lowMidi = note.midiNote);\r\n            // (note.midiNote>maxMidi)&&(maxMidi = note.midiNote);\r\n            this.intervalTree.insert([note.noteOn, note.noteOff, note]);\r\n        }\r\n        //set the width\r\n        console.log(duration * this.pixelsPerSecond)\r\n        // console.log(this.element);\r\n        // this.width = duration * this.pixelsPerSecond + window.innerWidth * 2;\r\n        this.width = duration * this.pixelsPerSecond;\r\n\r\n        this.element.style.width = this.width + \"px\";\r\n        return Math.round(noteHeight * Math.min(100, Math.max(lowMidi - 1, 0)));\r\n    }\r\n    /**\r\n     *  Resuze the drawing canvas\r\n     */\r\n    resize() {\r\n        this.canvasWidth = this.canvas.offsetWidth * 2;\r\n        this.canvasHeight = this.canvas.offsetHeight * 2;\r\n        // this.canvasWidth = this.canvas.offsetWidth;\r\n        // this.canvasHeight = this.canvas.offsetHeight;\r\n        this.context.canvas.width = this.canvasWidth;\r\n        this.context.canvas.height = this.canvasHeight;\r\n        if (this._currentNotes) {\r\n            this.setNotes(this._currentNotes);\r\n        }\r\n    }\r\n    /**\r\n     *  Returns the length of the score in seconds\r\n     *  @return  {Number}\r\n     */\r\n    getDuration() {\r\n        var lastOff = 0;\r\n        //get the last noteOff\r\n        for (var i = 0; i < this.notes.length; i++) {\r\n            if (this.notes[i].noteOff > lastOff) {\r\n                lastOff = this.notes[i].noteOff;\r\n            }\r\n        }\r\n        return lastOff;\r\n    }\r\n    /**\r\n     *  get the note attacks between 'from' and 'to' PIXELS!\r\n     *  @return  {Array}\r\n     */\r\n    showOnScreenNotes(from, to) {\r\n        var fromSeconds = from / this.pixelsPerSecond;\r\n        var toSeconds = to / this.pixelsPerSecond;\r\n        if (this.intervalTree !== null) {\r\n            var notes = [];\r\n            this.intervalTree.queryInterval(fromSeconds, toSeconds, function (res) {\r\n                notes.push(res[2]);\r\n            });\r\n            this.currentlyDisplayedNotes = notes;\r\n        }\r\n    }\r\n    /**\r\n     *  clear all of the children\r\n     */\r\n    clearNotes() {\r\n        for (var i = 0; i < this.notes.length; i++) {\r\n            var notes = this.notes[i];\r\n            notes.dispose();\r\n        }\r\n        this.notes = [];\r\n    }\r\n    /**\r\n     *  clean up\r\n     */\r\n    dispose() {\r\n        this.clearNotes();\r\n        this.element.remove();\r\n        this.element = null;\r\n    }\r\n    /**\r\n     *  Draw all of the onscreen notes\r\n     */\r\n    draw(offset) {\r\n        // console.log(offset);\r\n        this.context.clearRect(0, 0, this.canvasWidth, this.canvasHeight);\r\n        this.context.save();\r\n        this.drawBg(offset);\r\n        this.context.translate(-offset * 2, 0);\r\n\r\n        var notes = this.currentlyDisplayedNotes;\r\n        for (var i = 0; i < notes.length; i++) {\r\n            var n = notes[i];\r\n            n.draw(this.context);\r\n        }\r\n        this.context.restore();\r\n    }\r\n    drawBg(offset) {\r\n        const colors = [\"#282828\", \"#363636\"];\r\n        var oneHeight = (this.scrollC.offsetHeight - 25) / 128 * 2;\r\n        for (let i = 0; i < 128; i++) {\r\n            this.context.strokeStyle = colors[i % 2];\r\n            this.context.fillStyle = colors[i % 2];\r\n            this.context.fillRect(0, i * oneHeight, this.canvasWidth, oneHeight);\r\n        }\r\n        let oneW = this.pixelsPerSecond * 60 / this.bpm;\r\n\r\n        //    console.log(\"oneW\"+oneW);\r\n        var num;\r\n        var tmpoffset;\r\n        this.context.strokeStyle = \"#fff\";\r\n        this.context.lineWidth = 2;\r\n        if (oneW > 50) {\r\n            num = this.scrollC.offsetWidth / oneW * 2;\r\n            tmpoffset = offset % (oneW / 2);\r\n            for (let i = 1; i <= num + 1; i++) {\r\n\r\n                this.context.beginPath();\r\n                // this.context.moveTo(i*oneW*2,0);\r\n                this.context.moveTo(i * oneW - tmpoffset * 2, 0);\r\n                this.context.lineTo(i * oneW - tmpoffset * 2, this.canvasHeight);\r\n                this.context.closePath();\r\n                this.context.stroke();\r\n            }\r\n        }\r\n        else {\r\n            num = this.scrollC.offsetWidth / oneW;\r\n            tmpoffset = offset % oneW;\r\n            for (let i = 1; i <= num + 1; i++) {\r\n\r\n                this.context.beginPath();\r\n                // this.context.moveTo(i*oneW*2,0);\r\n                this.context.moveTo(i * oneW * 2 - tmpoffset * 2, 0);\r\n                this.context.lineTo(i * oneW * 2 - tmpoffset * 2, this.canvasHeight);\r\n                this.context.closePath();\r\n                this.context.stroke();\r\n            }\r\n        }\r\n        // console.log(tmpoffset);\r\n\r\n\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","\r\nimport { Score } from \"./Score\"\r\n// import { Scroll } from \"./Scroll\"\r\n\r\nexport class Roll {\r\n    constructor(head,wavesurfer) {\r\n\r\n        this.autoAdvance = false;\r\n        this.lastUpdate = -1;\r\n\r\n        this._wavesurfer = wavesurfer;\r\n        this._element = document.getElementById(\"RollContainer\");\r\n        this._scrollContainer = document.getElementById(\"ScrollContainer\");\r\n        this._scrollElement = document.getElementById(\"PianoRoll\");\r\n        this._scrollTopArea = document.getElementById(\"test\");\r\n        this._line = document.getElementById(\"line\");\r\n        // console.log(this._scrollTopArea);\r\n        this._head = head;\r\n        this._bpm = Math.round(this._head.tempos[0].bpm);\r\n        // console.log(this._bpm);\r\n        //display score\r\n\r\n\r\n        this._score = new Score(this._scrollElement, this._scrollContainer, this._bpm);\r\n\r\n        //scroll handler\r\n        // this._scroll = new Scroll(this._scrollContainer, this._score.pixelsPerSecond);\r\n\r\n\r\n        this._started = false;\r\n\r\n        //the current notes on the screen\r\n        this._currentNotes = [];\r\n\r\n        //if the scroll has changed, redraw\r\n        this._currentScroll = -1;\r\n        this._alreadyRun = -1;\r\n        //the time at the beginning of the piano roll\r\n        // this._computedStartTime = 0;\r\n        this._lastFlag = 0;\r\n        //set bpm\r\n\r\n        //a binding of the loop\r\n        this._bindedLoop = this._loop.bind(this);\r\n\r\n        // this._scrollContainer.scrollLeft = 0;\r\n        // this._onScreenNotes();\r\n        // this._score.draw(0);\r\n        //start the loop\r\n        // this._loop();\r\n\r\n        this._width = this._scrollContainer.offsetWidth;\r\n        document.getElementById(\"waveform\").style.width = document.getElementById(\"root\").offsetWidth + \"px\";\r\n        // this._currentScroll = this._scrollContainer.scrollLeft;\r\n        // this._onScreenNotes();\r\n        // this._score.draw(this._currentScroll);\r\n        window.addEventListener(\"resize\", this._resize.bind(this));\r\n        this._scrollContainer.onscroll= this._onscroll.bind(this);\r\n        this._scrollElement.onclick = this._onclick.bind(this);\r\n    }\r\n    _onclick(e){\r\n        // console.log(e)\r\n            this._wavesurfer.seekTo(e.offsetX/this._scrollElement.offsetWidth);\r\n    }\r\n    _onscroll(){\r\n        this._wavesurfer.drawer.wrapper.scrollLeft = this._scrollContainer.scrollLeft;\r\n    }\r\n    _resize() {\r\n        this._width = this._scrollContainer.offsetWidth;\r\n        document.getElementById(\"waveform\").style.width = document.getElementById(\"root\").offsetWidth + \"px\";\r\n        this._onScreenNotes();\r\n        this._score.draw(this._scrollContainer.scrollLeft);\r\n    }\r\n    _onScreenNotes() {\r\n        var width = this._width;\r\n        // this._score.showOnScreenNotes(this._currentScroll, this._currentScroll + width);\r\n        this._score.showOnScreenNotes(this._scrollContainer.scrollLeft, this._scrollContainer.scrollLeft + width);\r\n    }\r\n    changeLineLeft(currentTime, containerTimeLength, scrolledTime, waveScrollLeft, waveDuration) {\r\n        this._alreadyRun = currentTime * this._score.pixelsPerSecond;\r\n        this._line.style.left = this._alreadyRun + \"px\";\r\n        var tmpValue = (waveDuration - containerTimeLength) * this._score.pixelsPerSecond;\r\n        if (\r\n            scrolledTime + containerTimeLength < currentTime &&\r\n            currentTime <= waveDuration - containerTimeLength\r\n        ) {\r\n            this._scrollContainer.scrollLeft = waveScrollLeft + this._width;\r\n            // this._currentScroll = waveScrollLeft + this._width;\r\n            // this._scrollContainer.scrollLeft = this._currentScroll;\r\n            this._onScreenNotes();\r\n            this._score.draw(this._scrollContainer.scrollLeft);\r\n        } else if (currentTime < scrolledTime) {\r\n            this._scrollContainer.scrollLeft = currentTime * this._score.pixelsPerSecond;\r\n            this._onScreenNotes();\r\n            this._score.draw(this._scrollContainer.scrollLeft);\r\n        } else if ((currentTime > waveDuration - containerTimeLength) &&  (this._scrollContainer.scrollLeft<=tmpValue-5)) {\r\n            this._scrollContainer.scrollLeft = tmpValue;\r\n            this._onscroll();\r\n            this._onScreenNotes();\r\n            this._score.draw(this._scrollContainer.scrollLeft);\r\n            \r\n        }\r\n    }\r\n    changeScrollLeft(newV) {\r\n        this._scrollContainer.scrollLeft = newV;\r\n        this._onScreenNotes();\r\n        this._score.draw(this._scrollContainer.scrollLeft);\r\n    }\r\n    changeSeek(newv){\r\n        this._alreadyRun = newv;\r\n        this._line.style.left = this._alreadyRun + \"px\"; \r\n    }\r\n    _loop() {\r\n        // var currentTime = Date.now();\r\n        // requestAnimationFrame(this._bindedLoop);\r\n        \r\n        // var scrollLeft = this._scrollContainer.scrollLeft;\r\n        // if (this.lastUpdate !== -1 && this.autoAdvance) {\r\n        //     var delta = currentTime - this.lastUpdate;\r\n        //     this._currentScroll = this._alreadyRun;\r\n        //     this._currentScroll += (delta / 1000) * this._score.pixelsPerSecond;\r\n        //     // this._alreadyRun = this._currentScroll;\r\n        //     (this._alreadyRun >= this._scrollElement.offsetWidth) && (this.autoAdvance = false);\r\n        //     // this._line.style.left = this._alreadyRun +\"px\";\r\n        //     // this._line.style.left = (this._currentScroll- this._scrollContainer.scrollLeft) +\"px\";\r\n        //     // this._scrollContainer.scrollLeft = Math.round(this._currentScroll);\r\n        // }\r\n        // if (!this.autoAdvance && (scrollLeft !== this._currentScroll)) {\r\n        //     // console.log(this._currentScroll)\r\n        //     // console.log(scrollLeft);\r\n        //     // this._scrollContainer.scrollLeft = this._currentScroll;\r\n        //     this._currentScroll = scrollLeft;\r\n        //     // this._currentScroll = scrollLeft;\r\n        //     this._onScreenNotes();\r\n        //     this._score.draw(scrollLeft);\r\n        // }\r\n\r\n        // if (scrollLeft !== this._currentScroll) {\r\n        // if (this.autoAdvance && (scrollLeft + this._width < this._currentScroll || scrollLeft > this._alreadyRun || scrollLeft < this._alreadyRun - this._width)) {\r\n        //     // console.log(\"wwwwww\");\r\n        //     this._scrollContainer.scrollLeft = this._currentScroll;\r\n        //     // this._currentScroll = scrollLeft;\r\n        //     this._onScreenNotes();\r\n        //     this._score.draw(this._currentScroll);\r\n        // }\r\n        // //最后一个width\r\n\r\n        // if ((this._currentScroll + this._width > this._scrollElement.offsetWidth) && !this._lastFlag) {\r\n        //     // console.log(\"xxxxx\");\r\n        //     this._lastFlag = 1;\r\n        //     this._scrollContainer.scrollLeft = this._scrollElement.offsetWidth - this._width;\r\n        //     // this._currentScroll = scrollLeft;\r\n        //     this._onScreenNotes();\r\n        //     this._score.draw(this._scrollContainer.scrollLeft);\r\n        // }\r\n        // this.lastUpdate = currentTime;\r\n    }\r\n    /**\r\n     * set the json score\r\n     */\r\n    setScore(track, duration) {\r\n        // Transport.bpm.value = json.header.tempo;\r\n        // Transport.timeSignature = json.header.timeSignature;\r\n        //set the notes\r\n        let scrollTop = this._score.setNotes(track.notes, duration);\r\n        // scrollTop = 100;\r\n        // console.log(scrollTop);\r\n        this._scrollTopArea.scrollTop = scrollTop;\r\n        console.log(this._scrollTopArea.scrollTop);\r\n        //show the first notes initially\r\n        this._alreadyRun = 0;\r\n        this._currentScroll = 0;\r\n        this._scrollContainer.scrollLeft = this._currentScroll;\r\n        // console.log(this._scrollContainer.scrollLeft);\r\n        this._onScreenNotes();\r\n        this._score.draw(this._scrollContainer.scrollLeft);\r\n    }\r\n    start() {\r\n        this.autoAdvance = true;\r\n    }\r\n    stop() {\r\n        this.autoAdvance = false;\r\n\r\n    }\r\n    update(track, duration, head) {\r\n        // this._score.dispose();\r\n\r\n        this._head = head;\r\n        let scrollTop = this._score.setNotes(track.notes, duration);\r\n        this._scrollTopArea.scrollTop = scrollTop;\r\n        console.log(this._scrollTopArea.scrollTop);\r\n\r\n        this._onScreenNotes();\r\n        this._score.draw(this._scrollContainer.scrollLeft);\r\n    }\r\n    changeXAxis(value, oldV) {\r\n        // console.log(value);\r\n        // console.log(oldV);\r\n        this._score.pixelsPerSecond = value;\r\n        // this._currentScroll -=this._width;\r\n        this._currentScroll *= value / oldV;\r\n        this._alreadyRun *= value / oldV;\r\n        this._line.style.left = this._alreadyRun + \"px\";\r\n        this._scrollContainer.scrollLeft *= value / oldV;\r\n        // this._scroll.changePixelsPerSecond(200 * value, this._width);\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n"," <template>\r\n  <div>\r\n    <el-row id=\"datasource\">\r\n      <el-col :span=\"24\">\r\n        <el-card\r\n          class=\"box-card\"\r\n          style=\"text-align: left\"\r\n          :body-style=\"{ padding: '5px 20px' }\"\r\n        >\r\n          <div\r\n            slot=\"header\"\r\n            class=\"clearfix title\"\r\n            style=\"display: flex; align-items: center\"\r\n          >\r\n            <!-- <span>正式任务</span> -->\r\n            <el-tooltip\r\n              class=\"item\"\r\n              effect=\"dark\"\r\n              content=\"音轨背景色\"\r\n              placement=\"bottom\"\r\n            >\r\n              <el-color-picker\r\n                v-model=\"wvBackgroundColor\"\r\n                show-alpha\r\n                size=\"mini\"\r\n                @active-change=\"changeBackgroundColor\"\r\n              ></el-color-picker>\r\n            </el-tooltip>\r\n            <el-tooltip\r\n              class=\"item\"\r\n              effect=\"dark\"\r\n              content=\"未播放音轨颜色\"\r\n              placement=\"bottom\"\r\n            >\r\n              <el-color-picker\r\n                v-model=\"wvWaveColor\"\r\n                show-alpha\r\n                size=\"mini\"\r\n                @active-change=\"changeWaveColor\"\r\n                style=\"margin-left: 15px\"\r\n              ></el-color-picker>\r\n            </el-tooltip>\r\n            <el-tooltip\r\n              class=\"item\"\r\n              effect=\"dark\"\r\n              content=\"已播放音轨颜色\"\r\n              placement=\"bottom\"\r\n            >\r\n              <el-color-picker\r\n                v-model=\"wvProgressColor\"\r\n                show-alpha\r\n                size=\"mini\"\r\n                @active-change=\"changeProgressColor\"\r\n                style=\"margin-left: 15px\"\r\n              ></el-color-picker>\r\n            </el-tooltip>\r\n            <el-button\r\n              type=\"primary\"\r\n              size=\"mini\"\r\n              @click=\"resetColor\"\r\n              style=\"margin-left: 30px\"\r\n              >重置</el-button\r\n            >\r\n            <!-- <el-button type=\"primary\" size=\"mini\" @click=\"test\" style=\"margin-left: 30px;\">seek</el-button> -->\r\n            <span\r\n              v-if=\"mode == 'STUDY_MODE' && taskIdShow\"\r\n              style=\"position: absolute; right: 20px\"\r\n              ><el-tag>任务Id {{ this.taskId }}</el-tag>\r\n              <el-tag>itemId {{ this.itemId }}</el-tag>\r\n              <el-tag\r\n                >学习进度 {{ this.studyNumPass }} /\r\n                {{ this.studyNumAll }}</el-tag\r\n              >\r\n            </span>\r\n            <span\r\n              v-if=\"taskIdShow && mode != 'STUDY_MODE' && mode != 'CHECK_MODE'\"\r\n              style=\"position: absolute; right: 20px\"\r\n              ><el-tag>任务uid:{{ this.uid }}</el-tag>\r\n              <el-tag>taskId:{{ this.taskId }}</el-tag>\r\n              <el-tag>{{ this.audioName }}</el-tag>\r\n              <el-tag v-if=\"mode != 'LABEL_MODE '\"\r\n                >审核员:{{\r\n                  checkUserName ? checkUserName : checkUserId\r\n                }}</el-tag\r\n              ></span\r\n            >\r\n            <span\r\n              v-if=\"taskIdShow && mode == 'CHECK_MODE'\"\r\n              style=\"position: absolute; right: 20px\"\r\n              ><el-tag>任务uid:{{ this.uid }}</el-tag>\r\n              <el-tag>taskId:{{ this.taskId }}</el-tag>\r\n              <el-tag>{{ this.audioName }}</el-tag>\r\n              <el-tag>标注员：{{ labelUserName }}</el-tag></span\r\n            >\r\n          </div>\r\n          <div>\r\n            <div id=\"waveform\" ref=\"waveform\">\r\n              <!-- Here be the waveform -->\r\n            </div>\r\n            <div id=\"wave-timeline\" ref=\"wave-timeline\">\r\n              <!-- 时间轴 -->\r\n            </div>\r\n          </div>\r\n          <div class=\"ScrollArea\" id=\"test\">\r\n            <div class=\"container\" id=\"container\">\r\n              <!-- container -->\r\n              <div class=\"piano\">\r\n                <piano />\r\n              </div>\r\n              <div class=\"roll\">\r\n                <!-- <roll\r\n                  :track=\"showTrack\"\r\n                  :head=\"MidiHead\"\r\n                  :duration=\"duration\"\r\n                  :playing=\"playing\"\r\n                  :xAxis=\"value2 / 100 + 0.5\"\r\n                  v-if=\"update\"\r\n                /> -->\r\n                <div id=\"root\">\r\n                  <div id=\"RollContainer\">\r\n                    <div id=\"ScrollContainer\">\r\n                      <div id=\"PianoRoll\"></div>\r\n                      <div id=\"line\"></div>\r\n                    </div>\r\n                    <canvas id=\"ScoreCanvas\"></canvas>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <!-- <el-row> -->\r\n            <!-- <el-switch\r\n              v-model=\"value1\"\r\n              @change=\"changeMidi\"\r\n              active-text=\"YouveGotAFriend\"\r\n              inactive-text=\"IFeelTheEarthMove\"\r\n              style=\"margin: 10px 10px\"\r\n            >\r\n            </el-switch>\r\n            <el-button style=\"margin: 10px 10px\" @click=\"handleChange\">\r\n              Playing:{{ playing }}\r\n            </el-button> -->\r\n          <!-- </el-row> -->\r\n          <!-- <el-slider\r\n            v-model=\"value2\"\r\n            :step=\"10\"\r\n            :format-tooltip=\"formatTooltip\"\r\n            show-stops\r\n          >\r\n          </el-slider> -->\r\n          <el-row style=\"margin-top: 20px\">\r\n            <el-select\r\n              style=\"margin: 10px 10px\"\r\n              @change=\"onChange\"\r\n              v-model=\"tmpvalue\"\r\n              placeholder=\"当前未选择\"\r\n            >\r\n              <el-option\r\n                v-for=\"item in tracks\"\r\n                :key=\"'track' + item.index\"\r\n                :label=\"\r\n                  'Track:' + item.index + ' Instrument:' + item.instrument.name\r\n                \"\r\n                :value=\"item.index\"\r\n              >\r\n              </el-option>\r\n            </el-select>\r\n            <el-button\r\n              type=\"primary\"\r\n              size=\"small\"\r\n              @click=\"playMusic\"\r\n              style=\"margin-right: 10px\"\r\n            >\r\n              <i class=\"el-icon-video-play\"></i>\r\n              播放 /\r\n              <i class=\"el-icon-video-pausee\"></i>\r\n              暂停\r\n            </el-button>\r\n            <el-tooltip\r\n              class=\"item\"\r\n              effect=\"dark\"\r\n              content=\"放大倍率\"\r\n              placement=\"bottom\"\r\n            >\r\n              <el-input-number\r\n                size=\"small\"\r\n                v-model=\"value\"\r\n                :precision=\"0\"\r\n                :step=\"20\"\r\n                :min=\"80\"\r\n                :max=\"1500\"\r\n                @change=\"changeZoom\"\r\n              />\r\n            </el-tooltip>\r\n            <el-button\r\n              size=\"small\"\r\n              @click=\"changeLongHotKey\"\r\n              onfocus=\"this.blur()\"\r\n              style=\"margin-left: 10px\"\r\n              >一键放大</el-button\r\n            >\r\n            <el-button\r\n              size=\"small\"\r\n              @click=\"changeShortHotKey\"\r\n              onfocus=\"this.blur()\"\r\n              >一键缩小</el-button\r\n            >\r\n            <el-button\r\n              type=\"primary\"\r\n              size=\"small\"\r\n              @click=\"preview\"\r\n              onfocus=\"this.blur()\"\r\n              >预览</el-button\r\n            >\r\n            <!-- <el-button type=\"primary\" size=\"small\" @click=\"replay\">重放</el-button> -->\r\n            <el-tooltip\r\n              class=\"item\"\r\n              effect=\"dark\"\r\n              content=\"预览时长\"\r\n              placement=\"bottom\"\r\n            >\r\n              <el-popover\r\n                placement=\"top\"\r\n                width=\"220\"\r\n                trigger=\"click\"\r\n                style=\"margin-left: 10px\"\r\n              >\r\n                <el-input-number\r\n                  v-model=\"previewTime\"\r\n                  width=\"180\"\r\n                  :precision=\"2\"\r\n                  :step=\"0.1\"\r\n                  :min=\"0.1\"\r\n                  :max=\"10\"\r\n                  @change=\"changeSpace\"\r\n                />\r\n                <el-button slot=\"reference\" size=\"small\" round>\r\n                  {{ previewTime + \" s\" }}\r\n                </el-button>\r\n              </el-popover>\r\n            </el-tooltip>\r\n            <el-button\r\n              type=\"primary\"\r\n              size=\"small\"\r\n              @click=\"getTask\"\r\n              :disabled=\"getButtonAttr\"\r\n              onfocus=\"this.blur()\"\r\n              style=\"margin-left: 10px\"\r\n              >领取任务\r\n            </el-button>\r\n\r\n            <!-- <span v-if=\"!addButtonAttr\" style=\"margin-left:20px;color:#aaa\">下一句歌词：{{this.lyricsItems[this.labelData.length]}}</span> -->\r\n          </el-row>\r\n        </el-card>\r\n      </el-col>\r\n    </el-row>\r\n  </div>\r\n</template>\r\n<script>\r\nimport WaveSurfer from \"wavesurfer.js\";\r\nimport CursorPlugin from \"wavesurfer.js/dist/plugin/wavesurfer.cursor.js\";\r\nimport Timeline from \"wavesurfer.js/dist/plugin/wavesurfer.timeline.js\";\r\nimport Regions from \"wavesurfer.js/dist/plugin/wavesurfer.regions.js\";\r\nimport piano from \"./piano.vue\";\r\n// import roll from \"./roll.vue\";\r\nimport { Midi } from \"@tonejs/midi\";\r\nimport { Roll } from \"../roll/Roll.js\";\r\nexport default {\r\n  //   name: \"Table\",\r\n  //   mixins: [authorityCheck],\r\n  components: {\r\n    piano,\r\n    // roll,\r\n  },\r\n  props: {\r\n    mode: {\r\n      type: String,\r\n      default: \"LABEL_MODE\", // \"LABEL_MODE\" // 标注权限  \"CHECK_MODE\" //  审核权限  \"REVIEW_MODE\" // 内部验收权限\r\n    },\r\n    taskId: {\r\n      type: Number,\r\n      //for debug\r\n      default: 0,\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      tmpvalue: \"\",\r\n      // value2: 50,\r\n      playing: false,\r\n      tracks: [],\r\n      showTrack: {},\r\n      update: false,\r\n      value1: true,\r\n      MidiHead: {},\r\n      duration: 0,\r\n      notes: [],\r\n      roll: null,\r\n      //以上是\r\n      userToBeCheckedName: \"\",\r\n      studyNumAll: 0,\r\n      studyNumPass: 0,\r\n      checkBtnAttr: true, // 审核通过和不通过按钮属性\r\n      addButtonAttr: true, // 时间戳按钮属性\r\n      // taskId: 205,\r\n      checkUserId: \"\",\r\n      checkUserName: \"\",\r\n      audioName: \"\",\r\n      getButtonAttr: false, // 获取任务按钮属性\r\n      submitButtonAttr: true,\r\n      abandonButtonAttr: true,\r\n      labelDataOrigin: [],\r\n      labelData: [], // 全部表格数据\r\n      datetime: \"\", // 领取任务时间\r\n      lyricsItems: [], // 歌词\r\n      lyricsSaveItems: [], // 保存的数据\r\n      tablePageLength: 6, // 表格每页显示数量\r\n      currentPage: 1, // 当前显示页码\r\n      uid: null, // 任务号\r\n      itemId: null,\r\n      wavesurfer: null,\r\n      value: 400,\r\n      appointTime: 0, // 指定播放功能的播放时间点\r\n      rate: 1.0, // 播放倍速\r\n      pixel: 20, //一秒内像素值\r\n      getTaskTime: 0,\r\n      submitTaskTime: \"\",\r\n      taskIdShow: false,\r\n      dialogVisible: false, // 弹出框显示与否\r\n      errorDesOptions: [], // 错误原因描述选项\r\n      errOptionObj: {},\r\n      errorDes: null, // 错误原因描述\r\n      fontSize: 14, // 标注字体大小\r\n      fontSizeStyle: \"fontSizeOne\", // 默认样式\r\n      previewTime: 0.5, // 预览时长\r\n      trueResult: \"\",\r\n      errThre: 0, // 每句允许时间误差\r\n      errNumThre: 0, // 允许错误句数\r\n      errData: [], // 错误标注结果数组\r\n      errDataVisible: false,\r\n      rePaintTable: true,\r\n      flagArr: [], // 审核模式的标错控制锁数组\r\n      errDescriptions: [], // 返回后端的err详情\r\n      labelUserName: \"\",\r\n      isModified: null, // 是否是返修题\r\n      wvBackgroundColor: \"rgba(48, 65, 86,1)\",\r\n      wvWaveColor: \"rgba(192,196,204,1)\",\r\n      wvProgressColor: \"rgba(190,237,199,1)\",\r\n      flashWaveColor: true,\r\n      flashProgressColor: true,\r\n      // containerWidth: 0, // 容器宽度\r\n      waveScrollLeft: 0,\r\n      waveDuration: 0,\r\n    };\r\n  },\r\n  computed: {\r\n    containerTimeLength() {\r\n      return document.getElementById(\"waveform\").offsetWidth / this.value;\r\n    },\r\n    scrolledTime() {\r\n      return this.waveScrollLeft / this.value;\r\n    },\r\n  },\r\n  beforeMount() {\r\n    this.readStorage();\r\n  },\r\n  mounted() {\r\n    const that = this;\r\n\r\n    that.containerWidth = document.getElementById(\"waveform\").offsetWidth;\r\n    window.onresize = function () {\r\n      that.containerWidth = document.getElementById(\"waveform\").offsetWidth;\r\n    };\r\n    // 刷新页面也记录颜色配置：\r\n    window.addEventListener(\"beforeunload\", () => {\r\n      this.writeStroage();\r\n    });\r\n\r\n    // 标注模式下，起始放大倍率低点，方便标注\r\n    // if (this.mode == \"LABEL_MODE\") {\r\n    this.value = 200;\r\n    // }\r\n    this.$nextTick(() => {\r\n      this.wavesurfer = WaveSurfer.create({\r\n        //容器\r\n        container: this.$refs.waveform,\r\n        autoCenter: false,\r\n        partialRender: true,\r\n        pixelRatio: 1,\r\n        // 背景颜色\r\n        backgroundColor: this.wvBackgroundColor,\r\n        // 播放光标颜色\r\n        cursorColor: \"white\",\r\n        //未播放的波形填充颜色\r\n        waveColor: this.wvWaveColor,\r\n        //播放后的波形填充颜色\r\n        progressColor: this.wvProgressColor,\r\n        //基于的底层API，看浏览器支持情况\r\n        backend: \"MediaElement\",\r\n        //与backend配合使用\r\n        mediaControls: false,\r\n        // 播放音频的速度\r\n        audioRate: \"1\",\r\n        //给容器添加滚动条，否则将以固定宽度压缩在容器内部\r\n        scrollParent: true,\r\n        //填充满整个容器，否则采用一秒多少像素的方式呈现\r\n        fillParent: false,\r\n        //是否隐藏横向滚动条\r\n        hideScrollbar: false,\r\n        // minPxPerSec: this.value,\r\n        //窗口响应式变化\r\n        responsive: true,\r\n        plugins: [\r\n          // 光标插件\r\n          CursorPlugin.create({\r\n            showTime: true,\r\n            color: \"white\",\r\n            opacity: 1,\r\n            customStyle: {\r\n              width: \"21px\",\r\n              top: \"60px\",\r\n                bottom: \"60px\",\r\n              // bottom: \"100px\",\r\n              \"margin-left\": \"80px\",\r\n            },\r\n            customShowTimeStyle: {\r\n              \"background-color\": \"#000\",\r\n              color: \"#fff\",\r\n              padding: \"2px\",\r\n              // 'width': '22px',\r\n              \"font-size\": \"10px\",\r\n              marginTop: \"45px\",\r\n            },\r\n          }),\r\n          //使用时间轴插件\r\n          Timeline.create({\r\n            container: \"#wave-timeline\",\r\n            // deferInit: true\r\n          }),\r\n          // regions插件\r\n          Regions.create({\r\n            regions: [],\r\n            //wavesurfer对象最多能够有一个region\r\n            maxRegions: 1,\r\n            slop: 5,\r\n          }),\r\n        ],\r\n      });\r\n      // this.wavesurfer.on(\"play\", () => {\r\n      //   console.log(\"?????play\");\r\n      //   // this.waveDuration = this.wavesurfer.getDuration();\r\n      //   this.waveDuration = this.duration;\r\n      // });\r\n      // 监听播放事件\r\n      // this.wavesurfer.on('scroll',(e)=>{\r\n      //   this.waveScrollLeft = e.target.scrollLeft;\r\n      // })\r\n      this.wavesurfer.on(\"seek\", (e) => {\r\n        this.roll.changeSeek(e * this.waveDuration * this.value);\r\n      });\r\n      this.wavesurfer.on(\"scroll\", (e) => {\r\n        this.roll.changeScrollLeft(e.target.scrollLeft);\r\n        // console.log(e.target.scrollLeft);\r\n      });\r\n      this.wavesurfer.on(\"audioprocess\", (currentTime) => {\r\n        // console.log(currentTime);\r\n        this.waveScrollLeft = this.wavesurfer.drawer.wrapper.scrollLeft;\r\n        this.roll &&\r\n          this.roll.changeLineLeft(\r\n            currentTime,\r\n            this.containerTimeLength,\r\n            this.scrolledTime,\r\n            this.waveScrollLeft,\r\n            this.waveDuration\r\n          );\r\n        // console.log(this.waveScrollLeft);\r\n        if (\r\n          this.scrolledTime + this.containerTimeLength < currentTime &&\r\n          currentTime <= this.waveDuration - this.containerTimeLength\r\n        ) {\r\n          this.wavesurfer.drawer.wrapper.scrollLeft =\r\n            this.waveScrollLeft +\r\n            document.getElementById(\"waveform\").offsetWidth;\r\n        } else if (currentTime < this.scrolledTime) {\r\n          this.wavesurfer.drawer.wrapper.scrollLeft = currentTime * this.value;\r\n        } else if ((currentTime > this.waveDuration - this.containerTimeLength)) {\r\n          this.wavesurfer.drawer.wrapper.scrollLeft =(this.waveDuration - this.containerTimeLength) * this.value;\r\n        }\r\n      });\r\n      //绑定键盘事件\r\n      var _this = this;\r\n      document.fastKey = function () {\r\n        var key = window.event.keyCode;\r\n        if (key == 37) {\r\n          _this.backward();\r\n        } else if (key == 39) {\r\n          _this.forward();\r\n        } else if (key == 32) {\r\n          _this.playMusic();\r\n        } else if (key == 27) {\r\n          _this.clearRegs();\r\n        } else if (key == 13) {\r\n          _this.playSelect();\r\n        } else if (key == 65) {\r\n          _this.pageUp();\r\n        } else if (key == 68) {\r\n          _this.pageDown();\r\n        }\r\n      };\r\n      document.addEventListener(\"keydown\", document.fastKey);\r\n      //允许drag选择音频片段\r\n      this.wavesurfer.enableDragSelection({\r\n        id: 1,\r\n        color: \"rgba(55,188,201,0.5)\",\r\n        handleStyle: {\r\n          // 默认样式：\r\n          // cursor: 'col-resize',\r\n          // position: 'absolute',\r\n          // top: '0px',\r\n          // width: '1%',\r\n          // maxWidth: '4px',\r\n          // height: '100%',\r\n          // backgroundColor: 'rgba(0, 0, 0, 1)'\r\n          left: {\r\n            backgroundColor: \"rgba(255,255,255,1)\",\r\n          },\r\n          right: {\r\n            backgroundColor: \"rgba(255,255,255,1)\",\r\n          },\r\n        },\r\n      });\r\n      this.wavesurfer.on(\"ready\", () => {\r\n        console.log(\"readY!\")\r\n        this.waveDuration = this.duration;\r\n        this.wavesurfer.zoom(this.value);\r\n      });\r\n\r\n    });\r\n    \r\n  },\r\n  beforeDestroy() {\r\n    document.removeEventListener(\"keydown\", document.fastKey); // 组件销毁前移除绑定事件\r\n    this.instance && this.instance.close();\r\n    // 退出页面前保存颜色配置\r\n    this.writeStroage();\r\n  },\r\n\r\n  //   created() {\r\n  //     this.getMidi();\r\n  //   },\r\n  methods: {\r\n    formatTooltip(val) {\r\n      return val / 100 + 0.5;\r\n    },\r\n    handleChange() {\r\n      this.playing = !this.playing;\r\n    },\r\n    onChange() {\r\n      console.log(this.tmpvalue);\r\n      for (let track of this.tracks) {\r\n        track.index === this.tmpvalue && (this.showTrack = track);\r\n      }\r\n      // this.showTrack = this.tracks[parseInt(this.tmpvalue)];\r\n      console.log(this.showTrack);\r\n      this.roll.update(this.showTrack, this.duration, this.MidiHead);\r\n    },\r\n    changeMidi() {\r\n      this.tracks = [];\r\n      // this.value1 = !this.value1;\r\n      this.getMidi();\r\n    },\r\n    async getMidi() {\r\n      // console.log(\"!!!!!\");\r\n      // console.log(process.env.BASE_URL);\r\n      await Midi.fromUrl(\r\n        this.value1\r\n          ? `${process.env.BASE_URL}audio/0.mid`\r\n          : `${process.env.BASE_URL}audio/0.mid`\r\n      ).then((midi) => {\r\n        this.duration = midi.duration;\r\n        this.MidiHead = midi.header;\r\n        console.log(midi);\r\n        midi.tracks.forEach((track, index) => {\r\n          if (track.notes.length !== 0) {\r\n            let tmpTrack = track;\r\n            tmpTrack.index = index;\r\n            this.tracks.push(tmpTrack);\r\n          }\r\n        });\r\n        if (this.tracks.length !== 0) {\r\n          this.tmpvalue = this.tracks[0].index;\r\n          this.showTrack = this.tracks[0];\r\n        }\r\n        console.log(this.tracks);\r\n        console.log(this.showTrack);\r\n      });\r\n    },\r\n    abandonEventDone() {\r\n      this.getButtonAttr = false;\r\n      this.submitButtonAttr = true;\r\n    },\r\n    // 读取localStorage\r\n    readStorage() {\r\n      if (!window.localStorage) {\r\n        this.$message({\r\n          message: \"您的浏览器不支持缓存，建议使用最新Chrome浏览器！\",\r\n          type: \"warning\",\r\n        });\r\n      } else {\r\n        let storage = window.localStorage;\r\n        this.wvBackgroundColor = storage.getItem(\"backgroundColor\")\r\n          ? storage.getItem(\"backgroundColor\")\r\n          : \"rgba(48, 65, 86,1)\";\r\n        this.wvWaveColor = storage.getItem(\"waveColor\")\r\n          ? storage.getItem(\"waveColor\")\r\n          : \"rgba(192,196,204,1)\";\r\n        this.wvProgressColor = storage.getItem(\"progressColor\")\r\n          ? storage.getItem(\"progressColor\")\r\n          : \"rgba(190,237,199,1)\";\r\n      }\r\n    },\r\n    // 写入localStorage\r\n    writeStroage() {\r\n      if (!window.localStorage) {\r\n        this.$message({\r\n          message: \"您的浏览器不支持缓存，建议使用最新Chrome浏览器！\",\r\n          type: \"warning\",\r\n        });\r\n      } else {\r\n        let storage = window.localStorage;\r\n        storage.setItem(\"backgroundColor\", this.wvBackgroundColor);\r\n        storage.setItem(\"waveColor\", this.wvWaveColor);\r\n        storage.setItem(\"progressColor\", this.wvProgressColor);\r\n      }\r\n    },\r\n    changeBackgroundColor(val) {\r\n      this.wvBackgroundColor = val;\r\n      this.wavesurfer.setBackgroundColor(this.wvBackgroundColor);\r\n    },\r\n    changeWaveColor(val) {\r\n      this.wvWaveColor = val;\r\n      this.wavesurfer.setWaveColor(this.wvWaveColor);\r\n      this.flashWaveColor = !this.flashWaveColor;\r\n      // 强制刷新\r\n      if (this.flashWaveColor) {\r\n        this.wavesurfer.zoom(this.value + 1);\r\n      } else {\r\n        this.wavesurfer.zoom(this.value - 1);\r\n      }\r\n    },\r\n    changeProgressColor(val) {\r\n      this.wvProgressColor = val;\r\n      // console.log(this.wvProgressColor)\r\n      this.wavesurfer.setProgressColor(this.wvProgressColor);\r\n      // 强制刷新\r\n      this.flashProgressColor = !this.flashProgressColor;\r\n      if (this.flashProgressColor) {\r\n        this.wavesurfer.zoom(this.value + 0.5);\r\n      } else {\r\n        this.wavesurfer.zoom(this.value - 0.5);\r\n      }\r\n    },\r\n    resetColor() {\r\n      this.changeBackgroundColor(\"rgba(48, 65, 86,1)\");\r\n      this.changeWaveColor(\"rgba(192,196,204,1)\");\r\n      this.changeProgressColor(\"rgba(190,237,199,1)\");\r\n    },\r\n    playMusic() {\r\n      // \"播放/暂停\"按钮的单击触发事件，暂停的话单击则播放，正在播放的话单击则暂停播放\r\n      this.wavesurfer.playPause.bind(this.wavesurfer)();\r\n      this.playing = !this.playing;\r\n      this.playing ? this.roll.start() : this.roll.stop();\r\n    },\r\n    changeZoom(newV, oldV) {\r\n      // console.log(newV);\r\n      // console.log(oldV);\r\n      this.wavesurfer.zoom(this.value);\r\n      this.roll.changeXAxis(newV, oldV);\r\n      this.roll.update(this.showTrack, this.duration, this.MidiHead);\r\n      if (this.playing) this.roll.start();\r\n    },\r\n    changeLong() {\r\n      this.value = this.value + this.pixel;\r\n      this.wavesurfer.zoom(this.value);\r\n    },\r\n    changeLongHotKey() {\r\n      this.roll.changeXAxis(400, this.value);\r\n      this.roll.update(this.showTrack, this.duration, this.MidiHead);\r\n      if (this.playing) this.roll.start();\r\n      this.value = 400;\r\n      this.wavesurfer.zoom(this.value);\r\n    },\r\n    changeShort() {\r\n      if (this.value <= 80) {\r\n        this.$message({\r\n          message: \"无法再缩小了!\",\r\n          type: \"warning\",\r\n        });\r\n        return;\r\n      }\r\n\r\n      this.value = this.value - this.pixel;\r\n      this.wavesurfer.zoom(this.value);\r\n    },\r\n    changeShortHotKey() {\r\n      this.roll.changeXAxis(80, this.value);\r\n      this.roll.update(this.showTrack, this.duration, this.MidiHead);\r\n      if (this.playing) this.roll.start();\r\n      this.value = 80;\r\n      this.wavesurfer.zoom(this.value);\r\n    },\r\n    forward() {\r\n      this.wavesurfer.skip(0.5);\r\n    },\r\n    backward() {\r\n      this.wavesurfer.skip(-0.5);\r\n    },\r\n    clearRegs() {\r\n      this.wavesurfer.clearRegions();\r\n    },\r\n    changeSpace() {\r\n      this.wavesurfer.setPlaybackRate(this.rate);\r\n    },\r\n    // 播放选中选取\r\n    playSelect() {\r\n      if (Object.keys(this.wavesurfer.regions.list).length == 0) {\r\n        this.$message({\r\n          message: \"请先选择一段音频\",\r\n          type: \"warning\",\r\n        });\r\n      } else {\r\n        let start = 0;\r\n        let end = 0;\r\n        for (let key in this.wavesurfer.regions.list) {\r\n          start = this.wavesurfer.regions.list[key].start.toFixed(2);\r\n          end = this.wavesurfer.regions.list[key].end.toFixed(2);\r\n        }\r\n        this.wavesurfer.play(start, end);\r\n      }\r\n    },\r\n    // 添加选中的region\r\n    addSelect(row) {\r\n      if (Object.keys(this.wavesurfer.regions.list).length == 0) {\r\n        this.$message({\r\n          message: \"请先选择一段音频\",\r\n          type: \"warning\",\r\n        });\r\n      } else {\r\n        let start = 0;\r\n        let end = 0;\r\n        for (let key in this.wavesurfer.regions.list) {\r\n          start = this.wavesurfer.regions.list[key].start.toFixed(2);\r\n          end = this.wavesurfer.regions.list[key].end.toFixed(2);\r\n        }\r\n        row.labelTimeStart = start;\r\n        row.labelTimeEnd = end;\r\n        // this.wavesurfer.clearRegions(); // 点击添加后清空regions\r\n      }\r\n    },\r\n    preview() {\r\n      // let preTime = this.previewTime;\r\n      let timeNow = this.wavesurfer.getCurrentTime();\r\n      this.wavesurfer.play(timeNow, timeNow + this.previewTime);\r\n      // 预览结束返回开始播放位置\r\n      let time = (1 / this.rate) * this.previewTime * 1000;\r\n      setTimeout(() => {\r\n        this.wavesurfer.play(timeNow, timeNow);\r\n      }, time);\r\n    },\r\n    async getTask() {\r\n      // 修改模式默认有权限\r\n      //   if(this.mode != 'CHANGE_MODE'){\r\n      //     if (!this.authority) {\r\n      //       this.checkAuthority()\r\n      //       return ;\r\n      //     }\r\n      //   }\r\n      await this.getMidi();\r\n      this.containerWidth = document.getElementById(\"waveform\").offsetWidth;\r\n      if (this.roll !== null) {\r\n        console.log(\"update\");\r\n        // this.roll.update(this.track,this.duration,this.head);\r\n      } else {\r\n        console.log(\"new\");\r\n        console.log(this.MidiHead);\r\n        this.roll = new Roll(this.MidiHead, this.wavesurfer);\r\n        // console.log(\"bug\");\r\n        this.roll.setScore(this.showTrack, this.duration);\r\n      }\r\n      this.update = true;\r\n      if (this.playing) this.roll.start();\r\n      this.currentPage = 1; // 领取任务前切换页面为1\r\n      this.labelData = []; // 领取任务前先清空表格\r\n      const aData = new Date();\r\n      this.getTaskTime = Date.now(); // 获取领取任务时的时间点\r\n      this.datetime =\r\n        aData.getFullYear() +\r\n        \"-\" +\r\n        (aData.getMonth() + 1) +\r\n        \"-\" +\r\n        aData.getDate();\r\n      await this.wavesurfer.load(`${process.env.BASE_URL}audio/0.wav`);\r\n      this.wavesurfer.zoom(this.value);\r\n      this.itemId = null;\r\n      this.audioName = `${process.env.BASE_URL}audio/0.wav`.split(\"/\").slice(-1)[0];\r\n      this.uid = 113889;\r\n      if (this.mode == \"LABEL_MODE\") {\r\n        this.lyricsSaveItems = [];\r\n      }\r\n      this.taskIdShow = true;\r\n      this.getButtonAttr = true;\r\n      this.submitButtonAttr = false;\r\n      this.checkBtnAttr = false;\r\n      this.abandonButtonAttr = false;\r\n      this.clearRegs();\r\n    },\r\n  },\r\n};\r\n</script>\r\n<style scoped>\r\n#root {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n#line {\r\n  width: 2px;\r\n  z-index: 3;\r\n  background-color: yellow;\r\n  height: 100%;\r\n  display: flex;\r\n  position: absolute;\r\n  left: 0px;\r\n}\r\n#RollContainer {\r\n  position: relative;\r\n  width: 100%;\r\n  /* height: calc(100% - 25px); */\r\n  height: 100%;\r\n  /* left: 0px; */\r\n  /* top: 0px; */\r\n  overflow: hidden;\r\n}\r\n#TriggerLine {\r\n  position: absolute;\r\n  left: calc(50% - 3px / 2);\r\n  height: 100%;\r\n  background-color: black;\r\n  width: 3px;\r\n  z-index: 2;\r\n  opacity: 0.1;\r\n  pointer-events: none;\r\n}\r\n#ScoreCanvas {\r\n  width: 100%;\r\n  height: 100%;\r\n  position: absolute;\r\n  top: 0px;\r\n  left: 0px;\r\n  z-index: 0;\r\n  /* height: calc(100% - 25px); */\r\n}\r\n#ScrollContainer {\r\n  height: calc(100% + 25px);\r\n  /* height: 100%; */\r\n  width: 100%;\r\n  position: absolute;\r\n  top: 0px;\r\n  left: 0px;\r\n  overflow-y: hidden;\r\n  overflow-x: scroll;\r\n}\r\n#PianoRoll {\r\n  display: inline;\r\n  position: absolute;\r\n  width: 100%;\r\n  height: 100%;\r\n  top: 0px;\r\n  left: 0px;\r\n  z-index: 1;\r\n  background-color: transparent;\r\n}\r\n.ScrollArea {\r\n  margin: 10px auto;\r\n  /* width: 1800px; */\r\n  width: 100%;\r\n  height: 300px;\r\n  overflow-y: scroll;\r\n  overflow-x: hidden;\r\n}\r\n.container {\r\n  /* background-color: antiquewhite; */\r\n  display: flex;\r\n\r\n  /* width: calc(100% - 80px); */\r\n  height: 1500px;\r\n  margin: auto auto;\r\n}\r\n.page {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n.piano {\r\n  /* background-color:azure; */\r\n  width: 80px;\r\n  height: 100%;\r\n}\r\n.roll {\r\n  /* background-color: aquamarine; */\r\n  width: calc(100% - 80px);\r\n  height: 100%;\r\n}\r\n#waveform {\r\n  margin-left: 80px;\r\n}\r\n#wave-timeline {\r\n  margin-left: 80px;\r\n}\r\n#datasource {\r\n  margin: 10px;\r\n}\r\n#datalabel {\r\n  margin: 10px;\r\n}\r\n#lyrics {\r\n  margin: 20px;\r\n}\r\n.el-tag {\r\n  cursor: pointer;\r\n}\r\nli {\r\n  margin: 2px 0px;\r\n}\r\n.el-input--mini {\r\n  font-size: 14px;\r\n}\r\n.fontSizeOne {\r\n  font-size: 14 px;\r\n}\r\n.fontSizeTwo {\r\n  font-size: 16px;\r\n}\r\n.fontSizeThree {\r\n  font-size: 18px;\r\n}\r\n.fontSizeFour {\r\n  font-size: 20px;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Waveform.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Waveform.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Waveform.vue?vue&type=template&id=f76de944&scoped=true&\"\nimport script from \"./Waveform.vue?vue&type=script&lang=js&\"\nexport * from \"./Waveform.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Waveform.vue?vue&type=style&index=0&id=f76de944&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"f76de944\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div class=\"page\">\r\n    <h1>Here is a midi display demo by Molar~</h1>\r\n    <Waveform></Waveform>\r\n  </div>\r\n</template>\r\n<script>\r\nimport Waveform from \"./Waveform.vue\";\r\n\r\nexport default {\r\n  name: \"MidiDemo\",\r\n  data() {\r\n    return {\r\n    };\r\n  },\r\n  components: {\r\n    Waveform\r\n  },\r\n\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.ScrollArea {\r\n  margin: 10px auto;\r\n  width: 1800px;\r\n  height: 300px;\r\n  overflow-y: scroll;\r\n  overflow-x: hidden;\r\n}\r\n.page {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n.container {\r\n  /* background-color: antiquewhite; */\r\n  display: flex;\r\n\r\n  width: 1800px;\r\n  height: 1500px;\r\n  margin: auto auto;\r\n}\r\n.piano {\r\n  /* background-color:azure; */\r\n  width: 80px;\r\n  height: 100%;\r\n}\r\n.roll {\r\n  /* background-color: aquamarine; */\r\n  width: 1700px;\r\n  height: 100%;\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MidiDemo.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MidiDemo.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MidiDemo.vue?vue&type=template&id=36f5fc34&scoped=true&\"\nimport script from \"./MidiDemo.vue?vue&type=script&lang=js&\"\nexport * from \"./MidiDemo.vue?vue&type=script&lang=js&\"\nimport style0 from \"./MidiDemo.vue?vue&type=style&index=0&id=36f5fc34&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"36f5fc34\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div id=\"app\">\n    <!-- <img alt=\"Vue logo\" src=\"./assets/logo.png\"> -->\n    <!-- <HelloWorld msg=\"Welcome to Your Vue.js App\"/> -->\n    <MidiDemo/>\n  </div>\n</template>\n\n<script>\n// import HelloWorld from './components/HelloWorld.vue'\nimport MidiDemo from './components/MidiDemo.vue'\nexport default {\n  name: 'App',\n  components: {\n    // HelloWorld\n    MidiDemo\n  }\n}\n</script>\n\n<style>\n#app {\n  font-family: Avenir, Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n  margin-top: 60px;\n}\n</style>\n","import mod from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../node_modules/cache-loader/dist/cjs.js??ref--12-0!../node_modules/thread-loader/dist/cjs.js!../node_modules/babel-loader/lib/index.js!../node_modules/cache-loader/dist/cjs.js??ref--0-0!../node_modules/vue-loader/lib/index.js??vue-loader-options!./App.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./App.vue?vue&type=template&id=17eb2f13&\"\nimport script from \"./App.vue?vue&type=script&lang=js&\"\nexport * from \"./App.vue?vue&type=script&lang=js&\"\nimport style0 from \"./App.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import Vue from \"vue\"\r\nimport Vuex from \"vuex\"\r\n\r\nVue.use(Vuex)\r\n\r\nexport default new Vuex.Store({\r\n  state: {},\r\n  mutations: {},\r\n  actions: {}\r\n})\r\n","import Vue from 'vue'\nimport App from './App.vue'\nimport ElementUI from 'element-ui';\nimport 'element-ui/lib/theme-chalk/index.css';\nimport store from './store'\n\nVue.config.productionTip = false\nVue.use(ElementUI);\nnew Vue({\n  store,\n  render: h => h(App)\n}).$mount(\"#app\")\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./piano.vue?vue&type=style&index=0&id=746bffe9&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MidiDemo.vue?vue&type=style&index=0&id=36f5fc34&scoped=true&lang=css&\""],"sourceRoot":""}